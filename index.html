<html>

<head>
	<script type="text/javascript" src="https://unpkg.com/jquery"></script>
	<style>
		* {
			margin: 0px;
			padding: 0px;
		}

		body{
			position: fixed;
			top: 0px;
			left: 0px;
			right: 0px;
			bottom: 0px;
			background: #000;
			height: 100%;
		}

		.bg {
			--x: 0px;
			--y: 0px;
			--x-change-rate: 0.01;
			--y-change-rate: 0.01;
			position: absolute;
			top: calc(var(--x-change-rate) * -1 * 100%);
			left: calc(var(--y-change-rate) * -1 * 100%);
			width: calc((1 + var(--x-change-rate)) * 100%);
			height: calc((1 + var(--y-change-rate)) * 100%);
			margin: 0px;
			z-index: -999;
			background: url('kv_bg.jpg');
			background-size: cover !important;
			background-repeat: no-repeat !important;
			background-position: var(--x) var(--y) !important;
			transition: background-position .3s ease-out;
		}

		.kv {
			--x: 0px;
			--y: 0px;
			--x-change-rate: 0.04;
			--y-change-rate: 0.06;
			position: absolute;
			margin: 0px;
			top: 1.5%;
			right: calc(var(--x-change-rate) * 100% * -1);
			height: calc((var(--y-change-rate) + 1) * (100% - 1.5%));
			width: 100%;
			max-height: 2560px;
			max-width: 2560px;
			background-size: cover !important;
			background-repeat: no-repeat !important;
			background-position: var(--x) var(--y) !important;
			transition: background-position .3s ease-out;
		}

		.kv_chara_01 {
			background: url('kv_chara_01.png');
		}

		.kv_chara_02 {
			background: url('kv_chara_02.png');
		}

		.kv_chara_03 {
			background: url('kv_chara_03.png');
		}

		.kv_flare {
			--degree: 0deg;
			--degree-change-rate: 0.06;
			transform: rotate(var(--degree));
			transform-origin: top right;
			position: absolute;
			top: 0%;
			left: 0%;
			height: 100%;
			width: 100%;
			background-size: cover !important;
			background-repeat: no-repeat !important;
			background-position: top center !important;
			background: url('kv_flare.png');
			opacity: 0.5;
			mix-blend-mode: screen;
		}

		.dust {
			z-index: -99;
			position: absolute;
			left: 100%;
			top: 0px;
			background-size: cover !important;
			background-repeat: no-repeat !important;
			background-position: top center !important;
			transform: scale(0.7);
			opacity: 0.6;
		}

		.bg_dust_01 {
			background: url('bg_dust_01.png');
			width: 160px;
			height: 117px;
		}

		.bg_dust_02 {
			background: url('bg_dust_02.png');
			width: 134px;
			height: 117px;
		}

		.bg_dust_03 {
			background: url('bg_dust_03.png');
			width: 131px;
			height: 128px;
		}

		.bg_dust_04 {
			background: url('bg_dust_04.png');
			width: 168px;
			height: 136px;
		}
	</style>
</head>

<body>
	<div class="bg"></div>
	<div class="kv kv_chara_01"></div>
	<div class="kv kv_chara_02"></div>
	<div class="kv kv_chara_03"></div>
	<div class="kv_flare"></div>

	<script>

		setInterval(function () {

			let rand = Math.floor(Math.random() * 10000 + 1000);
			let top = Math.random() * 1000;
			let dust = '';
			let id = (Date.now()).valueOf() + rand;
			if (rand % 5 == 0) {
				dust = '<div class="dust dust bg_dust_01" id="' + id + '"></div>';
				top *= -1
			} else if (rand % 5 == 1) {
				dust = '<div class="dust dust bg_dust_02" id="' + id + '"></div>';
				top *= -1
			} else if (rand % 5 == 2) {
				dust = '<div class="dust dust bg_dust_03" id="' + id + '"></div>';
			} else if (rand % 5 == 3) {
				dust = '<div class="dust dust bg_dust_04" id="' + id + '"></div>';
			}

			time = Math.min(Math.max(rand, 3000), 7000);
			$('body').append(dust);
			$('#' + id).css({ 'top': top + 'px' });
			$('#' + id).animate({ 'margin-top': '50%', 'left': '-100px' }, time, 'linear', function () {
				$(this).remove();
			});


		}, 1500);

		$('body').mousemove(function (e) {
			let width = $('body').width();
			let height = $('body').height();

			let wr = e.offsetX / width;
			let hr = e.offsetY / height;

			let kv_xChangeRate = $('.kv').css('--x-change-rate');
			let kv_yChangeRate = $('.kv').css('--y-change-rate');

			let kv_xChangeRate_instand = kv_xChangeRate * 0.025;
			let kv_xChangeRate_outstand = kv_xChangeRate * 1.8;

			$('.kv').css({ '--x': e.offsetX * kv_xChangeRate * -1 + 'px', '--y': e.offsetY * kv_yChangeRate * -1 + 'px' });

			if (wr < 0.3) {
				$('.kv_chara_02').css({ '--x': e.offsetX * kv_xChangeRate_instand * -1 + 'px' });
				$('.kv_chara_03').css({ '--x': e.offsetX * kv_xChangeRate_instand * -1 + 'px' });
				// console.log('01');
			} else if (wr < 0.6) {
				$('.kv_chara_01').css({ '--x': e.offsetX * kv_xChangeRate_outstand * -1 + 'px' });
				$('.kv_chara_03').css({ '--x': e.offsetX * kv_xChangeRate_instand * -1 + 'px' });
				// console.log('02')
			} else {
				$('.kv_chara_01').css({ '--x': e.offsetX * kv_xChangeRate_outstand * -1 + 'px' });
				$('.kv_chara_02').css({ '--x': e.offsetX * kv_xChangeRate_outstand * -1 + 'px' });
				// console.log('03')
			}

			let bg_xChangeRate = $('.bg').css('--x-change-rate');
			let bg_yChangeRate = $('.bg').css('--y-change-rate');

			$('.bg').css({'--x': e.offsetX * bg_xChangeRate + 'px', '--y': e.offsetY * bg_yChangeRate + 'px'});
			

			let flare_degreeChangeRate = $('.kv_flare').css('--degree-change-rate');
			let flare_degree = Math.atan2(e.offsetY, width - e.offsetX) * (180 / Math.PI) * flare_degreeChangeRate;
			console.log(flare_degree);
			$('.kv_flare').css('--degree', flare_degree + 'deg');

		});
	</script>
</body>

</html>